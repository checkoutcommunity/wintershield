function resend(){$(".confirm .resend a").one("click",function(){$(this).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/login",data:{action:"resend"},cache:!1,dataType:"json",success:function(i){var e,s;i.error?"1"==i.code?window.location.replace("/panel/login"):($(".info").html("<div class='block'><div class='error'>"+i.error+"</div></div>"),$(".info .block").show("normal"),resend()):i.success&&("1"==i.code?$(".confirm .resend").hide().html(""):($(".confirm .resend").hide().addClass("inactive").html("Новый код можно отправить через <i>60</i> сек.").fadeIn("100"),e=$(".confirm .resend i").text(),s=setInterval(function(){1<e?(e--,$(".confirm .resend i").text(e)):(clearInterval(s),$(".confirm .resend").hide().removeClass("inactive").html("Не получили код? <a>Отправить новый</a>").fadeIn("100"),resend())},1e3)))},error:function(){$(".info").html("<div class='block'><div class='error'>Ошибка соединения с сервером</div></div>"),$(".info .block").show("normal")}})},300)})}$(document).ready(function(){$("body").removeClass("preload"),$(".float input, .float textarea").each(function(){$(this).wrap("<fieldset></fieldset>");var i=$(this).attr("placeholder");$(this).attr("placeholder",""),""==!$(this).val()?$(this).after("<label for='name' class='stay'>"+i+"</label>"):$(this).after("<label for='name'>"+i+"</label>")}),$(".float input, .float textarea").on("blur",function(){""==!$(this).val()?$(this).next().addClass("stay"):$(this).next().removeClass("stay")}),$(".form-control").live("focus",function(){$(this).removeClass("error")}),$(".register input").on("focus input",function(){"password"==$(this).attr("name")&&8<=$(".register input[name=password_repeat]").val().trim().length&&($(this).val()!=$(".register input[name=password_repeat]").val()?$(".register input[name=password_repeat]").addClass("error"):$(".register input[name=password_repeat]").removeClass("error"))}),$(".register input").on("blur",function(){var i=new RegExp(/^[a-z0-9._-]+@[a-z0-9-]+\.[a-z]{2,7}$/i);("email"==$(this).attr("name")&&!i.test($(this).val())||"password"==$(this).attr("name")&&$(this).val().trim().length<8||"password_repeat"==$(this).attr("name")&&$(this).val().trim().length<8||"password_repeat"==$(this).attr("name")&&$(this).val()!=$(".register input[name=password]").val())&&$(this).addClass("error")}),$(".register").live("submit",function(){return $($(this).serializeArray()).each(function(){this.value.trim().length<1&&$(".register input[name="+this.name+"]").addClass("error")}),$(this).find("input").hasClass("error")||($(".info .block").hide("normal"),$(".register button").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/register",data:$(".register").serialize()+"&action=register",cache:!1,dataType:"json",success:function(i){i.error?($(".info").html("<div class='block'><div class='error'>"+i.error+"</div></div>"),$(".info .block").show("normal"),i.highlight&&$(i.highlight.split(", ")).each(function(i,e){$(".register input[name="+e+"]").addClass("error")}),"1"==i.code&&grecaptcha.reset(),$(".register button").removeClass("disabled").prop("disabled",!1).html("Регистрация")):i.success&&($(".register").addClass("continue").removeClass("register"),$(".form-block").hide().html("<div class='form-group'>"+i.success+"</div><div class='form-group button'><button type='submit'>Продолжить</button></div>").fadeIn("100"))},error:function(){$(".info").html("<div class='block'><div class='error'>Ошибка соединения с сервером</div></div>"),$(".info .block").show("normal"),grecaptcha.reset(),$(".register button").removeClass("disabled").prop("disabled",!1).html("Регистрация")}})},300)),!1}),$(".forgot input").on("blur",function(){var i=new RegExp(/^[a-z0-9._-]+@[a-z0-9-]+\.[a-z]{2,7}$/i);"email"!=$(this).attr("name")||i.test($(this).val())||$(this).addClass("error")}),$(".forgot").live("submit",function(){return $($(this).serializeArray()).each(function(){this.value.trim().length<1&&$(".forgot input[name="+this.name+"]").addClass("error")}),$(this).find("input").hasClass("error")||($(".info .block").hide("normal"),$(".forgot button").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/forgot",data:$(".forgot").serialize()+"&action=forgot",cache:!1,dataType:"json",success:function(i){i.error?($(".info").html("<div class='block'><div class='error'>"+i.error+"</div></div>"),$(".info .block").show("normal"),i.highlight&&$(i.highlight.split(", ")).each(function(i,e){$(".forgot input[name="+e+"]").addClass("error")}),"1"==i.code&&grecaptcha.reset(),$(".forgot button").removeClass("disabled").prop("disabled",!1).html("Восстановить")):i.success&&($(".forgot").addClass("continue").removeClass("forgot"),$(".form-block").hide().html("<div class='form-group'>"+i.success+"</div><div class='form-group button'><button type='submit'>Продолжить</button></div>").fadeIn("100"))},error:function(){$(".info").html("<div class='block'><div class='error'>Ошибка соединения с сервером</div></div>"),$(".info .block").show("normal"),grecaptcha.reset(),$(".forgot button").removeClass("disabled").prop("disabled",!1).html("Восстановить")}})},300)),!1}),$(".login input").on("blur",function(){var i=new RegExp(/^[a-z0-9._-]+@[a-z0-9-]+\.[a-z]{2,7}$/i);("email"==$(this).attr("name")&&!i.test($(this).val())||"password"==$(this).attr("name")&&$(this).val().trim().length<8)&&$(this).addClass("error")}),$(".login").live("submit",function(){return $($(this).serializeArray()).each(function(){this.value.trim().length<1&&$(".login input[name="+this.name+"]").addClass("error")}),$(this).find("input").hasClass("error")||($(".info .block").hide("normal"),$(".login button").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/login",data:$(".login").serialize()+"&action=login",cache:!1,dataType:"json",success:function(i){i.error?($(".info").html("<div class='block'><div class='error'>"+i.error+"</div></div>"),$(".info .block").show("normal"),i.highlight&&$(i.highlight.split(", ")).each(function(i,e){$(".login input[name="+e+"]").addClass("error")}),"1"==i.code&&grecaptcha.reset(),$(".login button").removeClass("disabled").prop("disabled",!1).html("Войти")):i.success&&("1"==i.code?($(".login").addClass("confirm").removeClass("login"),$(".form-block").hide().html("<div class='form-group'>"+i.success+"</div><div class='form-group float'><input type='text' name='code' class='form-control' placeholder='Код подтверждения' maxlength='6' inputmode='numeric' autocomplete='off'></div><div class='form-group button'><button type='submit'>Подтвердить</button></div><div class='form-group resend'>Не получили код? <a>Отправить новый</a></div>").fadeIn("100"),$(".confirm input[name='code']").focus(),resend()):window.location.replace("/panel/main"))},error:function(){$(".info").html("<div class='block'><div class='error'>Ошибка соединения с сервером</div></div>"),$(".info .block").show("normal"),grecaptcha.reset(),$(".login button").removeClass("disabled").prop("disabled",!1).html("Войти")}})},300)),!1}),$(".continue").live("submit",function(){return $(".continue button").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){window.location.replace("/panel/login")},300),!1}),$(".confirm input[name=code]").live("input",function(){this.value!=this.value.replace(/[^0-9]/g,"")&&(this.value=this.value.replace(/[^0-9]/g,""))}),$(".confirm input[name=code]").live("blur",function(){new RegExp("^[0-9]{6}$").test($(this).val())||$(this).addClass("error")}),$(".confirm").live("submit",function(){return $($(this).serializeArray()).each(function(){this.value.trim().length<1&&$(".confirm input[name="+this.name+"]").addClass("error")}),$(this).find("input").hasClass("error")||($(".info .block").hide("normal"),$(".confirm button").addClass("disabled").prop("disabled",!0).html("<div class='preloader-wrapper active'><div class='spinner-layer'><div class='circle-clipper left'><div class='circle'></div></div><div class='gap-patch'><div class='circle'></div></div><div class='circle-clipper right'><div class='circle'></div></div></div></div>"),setTimeout(function(){$.ajax({type:"POST",url:"/panel/login",data:$(".confirm").serialize()+"&action=confirm",cache:!1,dataType:"json",success:function(i){i.error?"1"==i.code?window.location.replace("/panel/login"):"2"==i.code?($(".confirm").addClass("continue").removeClass("confirm"),$(".form-block").hide().html("<div class='form-group'>"+i.error+"</div><div class='form-group button'><button type='submit'>Продолжить</button></div>").fadeIn("100")):($(".info").html("<div class='block'><div class='error'>"+i.error+"</div></div>"),$(".info .block").show("normal"),i.highlight&&$(i.highlight.split(", ")).each(function(i,e){$(".confirm input[name="+e+"]").addClass("error")}),$(".confirm button").removeClass("disabled").prop("disabled",!1).html("Подтвердить")):i.success&&window.location.replace("/panel/main")},error:function(){$(".info").html("<div class='block'><div class='error'>Ошибка соединения с сервером</div></div>"),$(".info .block").show("normal"),$(".confirm button").removeClass("disabled").prop("disabled",!1).html("Подтвердить")}})},300)),!1})});